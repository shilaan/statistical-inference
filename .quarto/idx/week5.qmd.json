{"title":"Confidence intervals","markdown":{"headingText":"Confidence intervals","containsRefs":false,"markdown":"\nAn interval estimate of a parameter $\\theta$ is any pair of functions $L(\\pmb x)$ and $U(\\pmb x)$ of a sample $\\pmb x$ that satisfy $L(\\pmb x) \\le U(\\pmb x)$ for all $\\pmb x \\in \\chi$. $[L(\\pmb X), U(\\pmb X)]$ is called a random interval, confidence interval, or confidence set. \n\nThe coverage probability of an interval estimator $[L(\\pmb X), U(\\pmb X)]$ of a parameter $\\theta$ is the probability $P_\\theta\\Big(\\theta \\in [L(\\pmb X), U(\\pmb X)] \\Big)$. The confidence coefficient/level of an interval estimator $[L(\\pmb X), U(\\pmb X)]$ of a parameter $\\theta$ is the infimum of the coverage probabilities $\\inf_\\theta P_\\theta\\Big(\\theta \\in [L(\\pmb X), U(\\pmb X)] \\Big)$. \n\nNote: in the probability statement $P_\\theta\\Big(\\theta \\in [L(\\pmb X), U(\\pmb X)] \\Big)$, $\\theta$ is fixed and $\\pmb X$ is random: the probability statement refers to $\\pmb X$, not $\\theta$. \n\n## Duality between test statistics and confidence sets\n\nFor a level $\\alpha$ test with rejection region $R(\\theta_0)$, $C(\\pmb X) = \\Big[\\theta_0: \\pmb X \\notin R(\\theta_0) \\Big]$ is a $1 - \\alpha$ confidence set. Thus, we can always obtain the confidence set $C(\\pmb X)$ by inverting a test.    \n\nFor a $1 - \\alpha$ confidence set $C(\\pmb X)$, $R(\\theta_0) = \\Big[\\pmb X : \\theta_0 \\notin C(\\pmb X) \\Big]$ is the rejection region of a level $\\alpha$ test. \n\n## Example: Obtaining a confidence interval by inverting the t-test\n\nThe *t*-test for $H_0: \\mu = \\mu_0$ vs. $H_a: \\mu \\ne \\mu_0$ rejects $H_0$ if \n$$\n\\Bigg| \\frac{\\bar X - \\mu_0}{S/\\sqrt n} \\Bigg| > t_{n-1, \\frac{\\alpha}{2}}\n$$\n\nThis is an $\\alpha$ level test. Derive the appropriate confidence $1 - \\alpha$ interval. We have\n$$\n\\begin{split}\nR(\\mu_0) &= \\Bigg[\\pmb x:  \\Bigg| \\frac{\\bar x - \\mu_0}{s/\\sqrt n} \\Bigg| > t_{n-1, \\frac{\\alpha}{2}}\\Bigg] \\\\\n&=\\Bigg[\\pmb x:   \\frac{\\bar x - \\mu_0}{s/\\sqrt n} > t_{n-1, \\frac{\\alpha}{2}} ~\\text{ or }~ -\\Bigg(\\frac{\\bar x - \\mu_0}{s/\\sqrt n} \\Bigg) > t_{n-1, \\frac{\\alpha}{2}}  \\Bigg] \\\\\n&=\\Bigg[\\pmb x:   {\\bar x - \\mu_0} > t_{n-1, \\frac{\\alpha}{2}}\\frac{s}{\\sqrt n} ~\\text{ or }~ \\frac{\\bar x - \\mu_0}{s/\\sqrt n}  < -t_{n-1, \\frac{\\alpha}{2}}  \\Bigg] \\\\\n&=\\Bigg[\\pmb x:   {\\bar x} > \\mu_0 + t_{n-1, \\frac{\\alpha}{2}}\\frac{s}{\\sqrt n} ~\\text{ or }~ {\\bar x}  < \\mu_0 -t_{n-1, \\frac{\\alpha}{2}}\\frac{s}{\\sqrt n}  \\Bigg] \\\\\nC(\\pmb x) &= \\Big[\\mu_0: \\pmb x \\notin R(\\mu_0) \\Big] \\\\\n&= \\Bigg[\\mu_0:   {\\bar x} \\le \\mu_0 + t_{n-1, \\frac{\\alpha}{2}}\\frac{s}{\\sqrt n} ~\\text{ and }~ {\\bar x}  \\ge \\mu_0 -t_{n-1, \\frac{\\alpha}{2}}\\frac{s}{\\sqrt n}  \\Bigg] \\\\ \n&= \\Bigg[\\mu_0:   {\\bar x} - t_{n-1, \\frac{\\alpha}{2}}\\frac{s}{\\sqrt n} \\le \\mu_0  ~\\text{ and }~ {\\bar x} +t_{n-1, \\frac{\\alpha}{2}}\\frac{s}{\\sqrt n}  \\ge \\mu_0   \\Bigg] \\\\ \n&= \\Bigg[\\mu_0:   {\\bar x} - t_{n-1, \\frac{\\alpha}{2}}\\frac{s}{\\sqrt n} \\le \\mu_0  ~\\text{ and }~ \\mu_0  \\le{\\bar x} +t_{n-1, \\frac{\\alpha}{2}}\\frac{s}{\\sqrt n}    \\Bigg] \\\\ \n&= \\Bigg[\\mu_0:   {\\bar x} - t_{n-1, \\frac{\\alpha}{2}}\\frac{s}{\\sqrt n} \\le \\mu_0  \\le{\\bar x} +t_{n-1, \\frac{\\alpha}{2}}\\frac{s}{\\sqrt n}    \\Bigg] \\\\ \n&\\text{We have obtained the } 1- \\alpha \\text{ confidence interval}\\\\\nC(\\pmb X) &= \\Bigg[{\\bar X} - t_{n-1, \\frac{\\alpha}{2}}\\frac{S}{\\sqrt n}, {\\bar X} +t_{n-1, \\frac{\\alpha}{2}}\\frac{S}{\\sqrt n} \\Bigg]\n\\end{split}\n$$\n\n## Interval estimators based on pivots \n\nA random variable $Q(\\pmb X,\\theta)$ is a pivotal quantity (or pivot) if the distribution of $Q(\\pmb X, \\theta)$ is independent of all parameters. If $\\pmb X \\sim F(\\pmb x | \\theta)$ then $Q(\\pmb X, \\theta)$ given $\\theta$ has the same distribution for all values of $\\theta$. A pivot that is also a statistic (a function of the observed data $\\pmb X$) is called an ancillary statistic.  \n\nFor example, the distribution of the $T$ statistic $Q(\\pmb X, \\mu, \\sigma^2) =\\displaystyle T = \\frac{\\bar X - \\mu}{S/\\sqrt n} \\sim t_{n-1}$ does not depend on the parameters $\\mu$ and $\\sigma^2$. Thus, $T$ is a pivotal quantity, and using the pivot $T \\sim t_{n-1}$ , we have \n$$P\\Big(-t_{n-1,\\frac{\\alpha}{2}}  \\le T \\le t_{n-1,\\frac{\\alpha}{2}} \\Big) = 1-\\alpha$$\n\nIf $Q(\\pmb X, \\theta)$ is a pivot, we can find numbers $a$ and $b$ such that \n$$P_\\theta\\Big(a \\le Q(\\pmb X,\\theta) \\le b \\Big) \\ge 1 - \\alpha$$\nThen, $$C(\\pmb x) = \\Big[\\theta: a \\le Q(\\pmb x, \\theta) \\le b \\Big]$$ and $C(\\pmb X)$ is a $1 - \\alpha$ confidence set for $\\theta$. \n\nIf $Q(\\pmb x, \\theta)$ is an increasing function of $\\theta$, then $C(\\pmb x)$ has the form $$Q^{-1}(\\pmb x, a) \\le \\theta \\le Q^{-1}(\\pmb x, b)$$\n\nIf $Q(\\pmb x, \\theta)$ is a decreasing function of $\\theta$, then $C(\\pmb x)$ has the form $$Q^{-1}(\\pmb x, b) \\le \\theta \\le Q^{-1}(\\pmb x, a)$$\n  \n  \n## Example: Confidence interval based on the T pivot\n\nUsing the pivot $$T = \\frac{\\bar X - \\mu}{S/\\sqrt n} \\sim t_{n-1},$$\n\nwe have that \n\n$$\nP\\Big(-t_{n-1,\\frac{\\alpha}{2}} \\le T \\le t_{n-1,\\frac{\\alpha}{2}} \\Big) = 1 - \\alpha \n$$\n\nThus, \n$$\n\\begin{split}\nP\\Big(-t_{n-1,\\frac{\\alpha}{2}} \\le T \\le t_{n-1,\\frac{\\alpha}{2}} \\Big) \n&= P\\Big(-t_{n-1,\\frac{\\alpha}{2}} \\le \\frac{\\bar X - \\mu}{S/\\sqrt n}\\le t_{n-1,\\frac{\\alpha}{2}} \\Big) \\\\\n&=P\\Big(-t_{n-1,\\frac{\\alpha}{2}}\\frac{S}{\\sqrt n} \\le {\\bar X - \\mu}\\le t_{n-1,\\frac{\\alpha}{2}}\\frac{S}{\\sqrt n} \\Big) \\\\\n&=P\\Big(-\\bar X -t_{n-1,\\frac{\\alpha}{2}}\\frac{S}{\\sqrt n} \\le { - \\mu}\\le -\\bar X + t_{n-1,\\frac{\\alpha}{2}}\\frac{S}{\\sqrt n} \\Big) \\\\ \n&=P\\Big(\\bar X +t_{n-1,\\frac{\\alpha}{2}}\\frac{S}{\\sqrt n} \\ge { \\mu}\\ge \\bar X - t_{n-1,\\frac{\\alpha}{2}}\\frac{S}{\\sqrt n} \\Big) \\\\ \n&=P\\Big(\\bar X - t_{n-1,\\frac{\\alpha}{2}}\\frac{S}{\\sqrt n} \\le { \\mu}\\le  \\bar X +t_{n-1,\\frac{\\alpha}{2}}\\frac{S}{\\sqrt n}  \\Big) \\\\ \n&= 1 - \\alpha\n\\end{split}\n$$\n\nWe have obtained a $1 - \\alpha$ confidence interval\n$$\n\\Big[\\bar X - t_{n-1,\\frac{\\alpha}{2}}\\frac{S}{\\sqrt n},~ \\bar X +t_{n-1,\\frac{\\alpha}{2}}\\frac{S}{\\sqrt n}  \\Big]\n$$\n\n## Example: Confidence interval for $\\sigma^2$ based on a pivot \n\nWe have iid $X_i \\sim N(\\mu,\\sigma^2)$. Since $(n-1)S^2/\\sigma^2 \\sim \\chi^2_{n-1}$, we can find a $1-\\alpha$ confidence interval for $\\sigma^2$ by choosing $a$ and $b$ such that \n\n$$\nP\\Bigg(a \\le \\frac{(n-1)S^2}{\\sigma^2} \\le b \\Bigg) = P(a \\le \\chi^2_{n-1} \\le b) = 1 - \\alpha\n$$\n\nThis leads to a $1 - \\alpha$ confidence interval for $\\sigma^2$:\n\n$$\n\\Bigg[\\frac{(n-1)S^2}{b}, \\frac{(n-1)S^2}{a}   \\Bigg]\n$$\n\nTypically, we spread the probability equally over the two endpoints: \n\n$$\nP(a \\le \\chi^2_{n-1} \\le b) = P(-\\chi^2_{n-1,\\alpha/2} \\le \\chi^2_{n-1} \\le \\chi^2_{n-1,\\alpha/2})\n$$\n\n## Example: Asymptotic confidence coefficient\n\nWe have iid $X_i \\sim N(\\mu, \\sigma^2)$ and rejection region\n$$\n\\Bigg| \\frac{\\sqrt n (\\bar X - \\mu_0)}{S}  \\Bigg| > z_{\\alpha/2}\n$$\nThis test has asymptotic level $\\alpha$. An **asymptotic** $1 - \\alpha$ confidence interval is given by \n\n$$\n\\Big[\\bar X - z_{\\alpha/2}\\frac{S}{\\sqrt n},~  \\bar X + z_{\\alpha/2}\\frac{S}{\\sqrt n}\\Big]\n$$\n\n\n"},"formats":{"html":{"execute":{"fig-width":7,"fig-height":5,"fig-format":"retina","fig-dpi":96,"df-print":"default","error":false,"eval":true,"cache":null,"freeze":false,"echo":true,"output":true,"warning":true,"include":true,"keep-md":false,"keep-ipynb":false,"ipynb":null,"enabled":null,"daemon":null,"daemon-restart":false,"debug":false,"ipynb-filters":[],"engine":"markdown"},"render":{"keep-tex":false,"keep-yaml":false,"keep-source":false,"keep-hidden":false,"prefer-html":false,"output-divs":true,"output-ext":"html","fig-align":"default","fig-pos":null,"fig-env":null,"code-fold":"none","code-overflow":"scroll","code-link":false,"code-line-numbers":false,"code-tools":false,"tbl-colwidths":"auto","merge-includes":true,"latex-auto-mk":true,"latex-auto-install":true,"latex-clean":true,"latex-max-runs":10,"latex-makeindex":"makeindex","latex-makeindex-opts":[],"latex-tlmgr-opts":[],"latex-input-paths":[],"latex-output-dir":null,"link-external-icon":false,"link-external-newwindow":false,"self-contained-math":false,"format-resources":[]},"pandoc":{"standalone":true,"wrap":"none","default-image-extension":"png","to":"html","output-file":"week5.html"},"language":{},"metadata":{"lang":"en","fig-responsive":true,"quarto-version":"1.0.37","theme":"cosmo"},"extensions":{"book":{"multiFile":true}}}}}