{"title":"Large sample theory","markdown":{"headingText":"Large sample theory","containsRefs":false,"markdown":"\n## Convergence \n\nThe maximum likelihood estimator $\\hat\\theta_n$ is distributed $N(\\theta, (nI_\\theta)^{-1})$ for every $\\theta$, for large n.\n\nAn estimator $\\pmb{\\hat \\theta}$ of $\\pmb \\theta$ is weakly consistent if the estimator $\\pmb{\\hat \\theta}$ converges in probability to the true value $\\pmb \\theta$. An estimator $\\pmb{\\hat \\theta}$ of $\\pmb \\theta$ is strongly consistent if the estimator $\\pmb{\\hat \\theta}$ converges with probability one to the true value (i.e., converges almost surely to $\\pmb \\theta$). An estimator $\\pmb{\\hat \\theta}$ is asymptotically normal if $\\sqrt n(\\pmb{\\hat \\theta} - \\pmb\\theta)$ converges in distribution to a normal distribution with mean $\\pmb 0$ and covariance matrix $\\pmb \\Sigma$.\n$$\n\\begin{split}\n\\text{Weak consistency: }& \\pmb{\\hat \\theta} \\xrightarrow{P} \\pmb\\theta \\text{ as }n \\rightarrow \\infty \\\\\n\\text{Strong consistency: }& \\text{ For any } \\epsilon > 1,  P(\\lim_{n \\rightarrow \\infty}|\\pmb{\\hat \\theta} - \\pmb\\theta| < \\epsilon) = 1. \\text{ That is,}\\\\\n&\\pmb{\\hat \\theta} \\xrightarrow{\\text{a.s.}} \\pmb\\theta\\\\\n\\text{Asymptotic normality: }& \\sqrt n(\\pmb{\\hat \\theta} - \\pmb\\theta) \\xrightarrow{d} N(0, \\pmb\\Sigma)\n\\end{split}\n$$\n\n## Central limit theorem (CLT)\n\nLet $X_1, X_2, ...$ be a sequence of iid random variables with $E(X_i) = \\mu$ and $Var(X_i) = \\sigma^2$. Then\n$$\n\\begin{split}\n\\frac{\\sqrt n (\\bar X_n - \\mu)}{\\sigma} &\\xrightarrow{D} N(0,1)\\\\\n\\frac{\\sqrt n (\\bar X_n - \\mu)}{\\sigma} &\\approx N(0,1) \\\\\n\\sqrt n (\\bar X_n - \\mu) &\\xrightarrow{D} N(0, \\sigma^2)\n\\end{split}\n$$\n\n## Delta method \n\n$$\n\\begin{split}\n\\text{Let } X_n &\\text{ be a sequence of RVs s.t.} \\\\\n\\sqrt n(X_n - \\theta) &\\xrightarrow{D} N(0, \\sigma^2) \\\\\n&\\text{Then, } \\\\\n\\sqrt n\\Big(g(X_n) - g(\\theta)\\Big) &\\xrightarrow{D} N\\Big(0, \\sigma^2\\Big[g'(\\theta)\\Big]^2\\Big)\n\\end{split}\n$$\n\nSome useful identities to obtain $N(0,1)$:\n$$\n\\begin{split}\nN(0, k) &= \\sqrt k N(0,1) \\\\\nN(0, k^2) &= kN(0,1) \\\\\nN(\\mu, k^2) &= kN(\\frac{\\mu}{k}, 1)\n\\end{split}\n$$\n\nConsider iid random observations $X_1, X_2,...$ with $E(X_i) = \\mu$ and $Var(X_i) = \\sigma^2 < \\infty$. We want to estimate $1/\\mu$. Use the Delta Method to obtain the asymptotic distribution of $\\sqrt n\\Big(\\frac{1}{\\bar X_n} - \\frac{1}{\\mu}\\Big)$. We have (from the CLT):  \n\n$$\n\\begin{split}\n\\sqrt n\\Big({\\bar X_n} - {\\mu}\\Big) &\\xrightarrow{D} N(0, \\sigma^2) \\\\\n\\sqrt n\\Big(g(X_n) - g(\\theta)\\Big) &\\xrightarrow{D} N\\Big(0, \\sigma^2\\Big[g'(\\theta)\\Big]^2\\Big) \\\\\n\\text{where } g(\\theta) = \\frac{1}{\\theta},~ g'(\\theta) &= -\\frac{1}{\\theta^2}, g'(\\theta)^2 = \\frac{1}{\\theta^4}, \\text{ and } \\theta = \\mu \\\\\n\\sqrt n\\Big(\\frac{1}{\\bar X_n} - \\frac{1}{\\mu}\\Big) &\\xrightarrow{D} N\\Big(0, \\frac{\\sigma^2}{\\mu^4}\\Big) \\\\\n\\sqrt n\\Big(\\frac{1}{\\bar X_n} - \\frac{1}{\\mu}\\Big) &\\xrightarrow{D} \\frac{\\sigma}{\\mu^2}N\\Big(0, 1\\Big) \\\\\n\\text{Using Slutsky's} &\\text{ lemma}, \\\\\n\\frac{\\sqrt n\\Big(\\frac{1}{\\bar X_n} - \\frac{1}{\\mu}\\Big)}{\\sigma / \\mu^2} &\\xrightarrow{D} N\\Big(0, 1\\Big) \\\\\n\\text{Plugging in consistent} &\\text{ estimators}, \\\\\n\\frac{\\sqrt n\\Big(\\frac{1}{\\bar X_n} - \\frac{1}{\\mu}\\Big)}{\\sqrt{S^2_n} / \\bar X^2_n} &\\xrightarrow{D} N\\Big(0, 1\\Big)\n\\end{split}\n$$\n\n## Variance stabilizing transformations \n\nWe have $X_1, X_2, ...$ iid Poisson($\\lambda$) random variables. Find an appropriate variance stabilizing transformation. We have\n$$\n\\begin{split}\nE[X_i] = \\text{Var}[X_i] &= \\lambda. \\text{From the CLT, } \\\\\n\\sqrt n (\\bar X_n - \\lambda) &\\xrightarrow{D}N(0,\\lambda) \\\\\n\\text{We wish to find a function } &g(\\lambda) \\text{ such that} \\\\\n\\lambda\\Big[g'(\\lambda)\\Big]^2 &= c. \\\\\n\\text{A great candidate would be } c &= 1, \\text{such that} \\\\\n[g'(\\lambda)\\Big]^2 &= \\frac{1}{\\lambda} \\\\\ng'(\\lambda) &= \\sqrt{\\frac{1}{\\lambda}} = \\lambda^{-1/2} \\\\\ng(\\lambda) &= \\int \\lambda^{-1/2} ~d\\lambda \\\\\n&= \\frac{1}{1/2} \\lambda^{1/2} \\\\\n&= 2\\sqrt\\lambda \\\\\n\\text{Using the Delta method to } &\\text{confirm, we have} \\\\\n\\sqrt n\\Big(g(X_n) - g(\\lambda)\\Big) &\\xrightarrow{D} N\\Big(0, \\lambda\\Big[g'(\\lambda)\\Big]^2\\Big) \\\\\n\\sqrt n\\Big(2\\sqrt{X_n} - 2\\sqrt{\\lambda}\\Big) &\\xrightarrow{D} N\\Big(0, \\lambda\\Big[g'(\\lambda)\\Big]^2\\Big) \\\\\n&\\xrightarrow{D} N\\Big(0, \\lambda\\Big[\\frac{1}{\\sqrt \\lambda}\\Big]^2\\Big) \\\\\n&\\xrightarrow{D} N\\Big(0, \\lambda\\frac{1}{\\lambda}\\Big) \\\\\n&\\xrightarrow{D} N\\Big(0, 1\\Big) \\\\\n\\end{split}\n$$\n\n\n"},"formats":{"html":{"execute":{"fig-width":7,"fig-height":5,"fig-format":"retina","fig-dpi":96,"df-print":"default","error":false,"eval":true,"cache":null,"freeze":false,"echo":true,"output":true,"warning":true,"include":true,"keep-md":false,"keep-ipynb":false,"ipynb":null,"enabled":null,"daemon":null,"daemon-restart":false,"debug":false,"ipynb-filters":[],"engine":"markdown"},"render":{"keep-tex":false,"keep-yaml":false,"keep-source":false,"keep-hidden":false,"prefer-html":false,"output-divs":true,"output-ext":"html","fig-align":"default","fig-pos":null,"fig-env":null,"code-fold":"none","code-overflow":"scroll","code-link":false,"code-line-numbers":false,"code-tools":false,"tbl-colwidths":"auto","merge-includes":true,"latex-auto-mk":true,"latex-auto-install":true,"latex-clean":true,"latex-max-runs":10,"latex-makeindex":"makeindex","latex-makeindex-opts":[],"latex-tlmgr-opts":[],"latex-input-paths":[],"latex-output-dir":null,"link-external-icon":false,"link-external-newwindow":false,"self-contained-math":false,"format-resources":[]},"pandoc":{"standalone":true,"wrap":"none","default-image-extension":"png","to":"html","output-file":"week2.html"},"language":{},"metadata":{"lang":"en","fig-responsive":true,"quarto-version":"1.0.37","theme":"cosmo"},"extensions":{"book":{"multiFile":true}}}}}